var N=Object.defineProperty;var O=(t,e,n)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var i=(t,e,n)=>(O(t,typeof e!="symbol"?e+"":e,n),n),h=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var p=(t,e,n)=>(h(t,e,"read from private field"),n?n.call(t):e.get(t)),w=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},E=(t,e,n,s)=>(h(t,e,"write to private field"),s?s.call(t,n):e.set(t,n),n);import{m as y,c as I,B as P,U as D,a as L,b as C,d as W,e as j,f as B,g as M,h as H,i as F,q as $,j as V,k as J,l as q,r as d,n as o,T as v,F as U,S as z,M as G,o as Q,C as Y,p as Z,s as K,t as X,u as k,v as ee,w as te}from"./vendor-OZYs-bN0.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();class re{constructor(){i(this,"navigateHandler");i(this,"currentPathname");i(this,"navigate",(e,n)=>{var s;(s=this.navigateHandler)==null||s.call(this,e,n)});i(this,"init",e=>{this.navigateHandler=e.navigate});i(this,"updatePathname",e=>{this.currentPathname=e});var e;this.currentPathname=((e=globalThis.location)==null?void 0:e.pathname)??"",y(this)}get pathname(){return this.currentPathname}}new re;const ne={bold:{woff:D,woff2:L},light:{woff:C,woff2:W},regular:{woff:j,woff2:B},medium:{woff:M,woff2:H}},se=I({brand:P.DEFAULT,fontsUrls:ne});class A extends Error{constructor({errors:n}){super(n[0].message);i(this,"errors");this.errors=n}}const ae=(t={})=>{const e=[];let n=()=>new A({errors:[{message:"Неизвестная ошибка",additionalInfo:{}}]});const s=F.create({timeout:3e3,paramsSerializer:{serialize:r=>$.stringify(r)},...t});return V(s,{retries:3}),s.subscribeOnError=r=>{e.push(r)},s.initErrorFormatter=r=>{n=r},s.interceptors.response.use(r=>r,r=>(e.forEach(a=>{a(r)}),Promise.reject(n(r)))),s.init=r=>(r&&(s.defaults.baseURL=r.baseURL),s),s},oe=401,ie=400,ce=404,de=500,_={code:ie,message:"Ошибка запроса"},R={code:ce,message:"Сервер не отвечает"},f={code:oe,message:"Пользователь не авторизован"},m={httpCode:de,message:"Неизвестная ошибка"};var c;class le{constructor(){w(this,c,void 0);this.config={}}init(e){this.config=e}get config(){if(!p(this,c))throw Error("ConfigService is not initialized");return p(this,c)}set config(e){E(this,c,e)}}c=new WeakMap;const g=new le;class l extends A{}const ue=t=>{var e,n;return((e=t==null?void 0:t.response)==null?void 0:e.status)===f.code?{statusCode:f.code,errors:[{message:f.message,additionalInfo:{}}]}:((n=t.response)==null?void 0:n.data)||{statusCode:m.httpCode,errors:[{message:m.message,additionalInfo:{}}]}},pe=t=>{const e=ue(t),{statusCode:n}=e;if(e.errors&&e.errors.length)return new l({errors:e.errors});switch(n){case _.code:return new l({errors:[{message:_.message,additionalInfo:{}}]});case R.code:return new l({errors:[{message:R.message,additionalInfo:{}}]});default:return new l({errors:[{message:m.message,additionalInfo:{}}]})}},fe=ae(),me=()=>{fe.init({baseURL:g.config.apiUrl}).initErrorFormatter(pe)};class ge{constructor(e){i(this,"captureException",J);i(this,"init",e=>{q({dsn:e.monitoringDsn,release:e.monitoringRelease,dist:e.monitoringStand,tracesSampleRate:1})});this.init(e)}}const he=new ge(g.config),we=new URLSearchParams(window.location.hash.split("?")[1]),{users:S,fileData:T}=JSON.parse(we.get("data")||"{}");let b;const Ee=()=>{const[t,e]=d.useState(),n=()=>{const r=S.find(a=>`${a.first_name} ${a.last_name}`===b);window.Telegram.WebApp.sendData(JSON.stringify({data:r,fileData:T,type:"sign"}))},s=r=>{e(r.target.value),b=r.target.value,window.Telegram.WebApp.MainButton.show()};return d.useEffect(()=>{window.Telegram.WebApp.MainButton.setText("Отправить"),window.Telegram.WebApp.MainButton.onClick(n),window.Telegram.WebApp.ready()},[]),d.useEffect(()=>{t||window.Telegram.WebApp.MainButton.hide()},[t]),o.jsxs("div",{style:{padding:"50px 12px 12px",display:"grid",gap:20},children:[o.jsx(v,{variant:"h4",children:"Выберите получателя для файла:"}),o.jsx("div",{style:{maxWidth:300},children:o.jsx(U,{variant:"h4",color:"info",children:T.fileName})}),o.jsx(z,{label:"Получатель",placeholder:"Выберите получателя",value:t,onChange:s,children:S.map(r=>o.jsxs(G,{value:`${r.first_name} ${r.last_name}`,children:[r.first_name," ",r.last_name]}))})]})},_e=new URLSearchParams(window.location.hash.split("?")[1]),{user:Re,fileData:x}=JSON.parse(_e.get("data")||"{}"),Se=()=>{const t=()=>{window.Telegram.WebApp.MainButton.showProgress(),setTimeout(()=>{window.Telegram.WebApp.sendData(JSON.stringify({data:{user:Re,fileData:x}}))},2e3)};return d.useEffect(()=>{window.Telegram.WebApp.MainButton.setText("Подписать"),window.Telegram.WebApp.MainButton.onClick(t),window.Telegram.WebApp.MainButton.show(),window.Telegram.WebApp.ready()},[]),o.jsxs("div",{style:{padding:"50px 12px 12px",display:"grid",gap:20},children:[o.jsx(v,{variant:"h4",children:"Подписание файла:"}),o.jsx("div",{style:{maxWidth:300},children:o.jsx(U,{variant:"h4",color:"info",children:x.fileName})})]})},Te=new URLSearchParams(window.location.hash.split("?")[1]);g.init({apiUrl:window.__ENV__.PUBLIC_API_URL,monitoringDsn:window.__ENV__.PUBLIC_SENTRY_DSN,monitoringStand:window.__ENV__.PUBLIC_SENTRY_ENV,monitoringRelease:window.__ENV__.PUBLIC_RELEASE_TAG});me();ee(typeof window>"u");const be=Q(()=>o.jsx(Y,{imagesMap:{noDataImgSrc:Z,defaultErrorImgSrc:K,outdatedReleaseErrorImgSrc:X},captureException:he.captureException,children:o.jsx(k,{theme:se,children:Te.get("type")==="select"?o.jsx(Ee,{}):o.jsx(Se,{})})})),xe=()=>{const t=document.getElementById("root");if(!t)throw Error("Рут не найден");te(t).render(o.jsx(d.StrictMode,{children:o.jsx(be,{})}))};xe();
//# sourceMappingURL=index-Zo7jn_xf.js.map
